/*
 * rtc-everywhere.js v0.0.4
 * Cross-everything WebRTC Adapter/Polyfill
 * Copyright 2016 Contra <yo@contra.io> (http://contra.io)
 * License MIT
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.rtcEverywhere=e()}}(function(){var e;return function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(t){var n=e[a][1][t];return o(n?n:t)},d,d.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";var r=e("./lib/findPlatform");t.exports=function(e){e||(e={});var t=r(e),n=t.platform.rtc(e),o=t.platform.gum(e),i=t.platform.attachStream(e),a=!!n.RTCPeerConnection;return{platform:t.name,supported:a,getUserMedia:o,RTCPeerConnection:n.RTCPeerConnection,RTCSessionDescription:n.RTCSessionDescription,RTCIceCandidate:n.RTCIceCandidate,attachStream:i}},t.exports.platforms=r.platforms},{"./lib/findPlatform":3}],2:[function(e,t,n){"use strict";function r(e,t){t.setAttribute("style",t.style.cssText+e.style.cssText),t.className?t.className=t.className+" "+e.className:t.className=e.className}t.exports=r},{}],3:[function(e,t,n){"use strict";function r(e){var t=i[e];return t&&t.match&&t.match()}function o(e){var t,n=a;if(e&&e.platforms){if(!Array.isArray(e.platforms))throw new Error("Invalid platforms option");n=n.filter(function(t){return-1!==e.platforms.indexOf(t)})}if(e&&e.platform){if(-1===n.indexOf(e.platform))throw new Error("Invalid platform option");t=e.platform}else t=n.filter(r)[0];return{name:t||"unsupported",platform:i[t]||i.unsupported}}var i={chrome:{attachStream:e("../platforms/chrome/attachStream.js"),gum:e("../platforms/chrome/gum.js"),match:e("../platforms/chrome/match.js"),rtc:e("../platforms/chrome/rtc.js")},"cordova-ios":{attachStream:e("../platforms/cordova-ios/attachStream.js"),gum:e("../platforms/cordova-ios/gum.js"),match:e("../platforms/cordova-ios/match.js"),rtc:e("../platforms/cordova-ios/rtc.js")},edge:{attachStream:e("../platforms/edge/attachStream.js"),gum:e("../platforms/edge/gum.js"),match:e("../platforms/edge/match.js"),rtc:e("../platforms/edge/rtc.js")},firefox:{attachStream:e("../platforms/firefox/attachStream.js"),gum:e("../platforms/firefox/gum.js"),match:e("../platforms/firefox/match.js"),rtc:e("../platforms/firefox/rtc.js")},ie:{attachStream:e("../platforms/ie/attachStream.js"),gum:e("../platforms/ie/gum.js"),match:e("../platforms/ie/match.js"),rtc:e("../platforms/ie/rtc.js")},node:{attachStream:e("../platforms/node/attachStream.js"),gum:e("../platforms/node/gum.js"),match:e("../platforms/node/match.js"),rtc:e("../platforms/node/rtc.js")},"react-native":{attachStream:e("../platforms/react-native/attachStream.js"),gum:e("../platforms/react-native/gum.js"),match:e("../platforms/react-native/match.js"),rtc:e("../platforms/react-native/rtc.js")},safari:{attachStream:e("../platforms/safari/attachStream.js"),gum:e("../platforms/safari/gum.js"),match:e("../platforms/safari/match.js"),rtc:e("../platforms/safari/rtc.js")},unsupported:{attachStream:e("../platforms/unsupported/attachStream.js"),gum:e("../platforms/unsupported/gum.js"),rtc:e("../platforms/unsupported/rtc.js")}},a=Object.keys(i);t.exports=o,t.exports.platforms=a},{"../platforms/chrome/attachStream.js":48,"../platforms/chrome/gum.js":49,"../platforms/chrome/match.js":50,"../platforms/chrome/rtc.js":51,"../platforms/cordova-ios/attachStream.js":52,"../platforms/cordova-ios/gum.js":53,"../platforms/cordova-ios/match.js":54,"../platforms/cordova-ios/rtc.js":55,"../platforms/edge/attachStream.js":56,"../platforms/edge/gum.js":57,"../platforms/edge/match.js":58,"../platforms/edge/rtc.js":59,"../platforms/firefox/attachStream.js":60,"../platforms/firefox/gum.js":61,"../platforms/firefox/match.js":62,"../platforms/firefox/rtc.js":63,"../platforms/ie/attachStream.js":64,"../platforms/ie/gum.js":65,"../platforms/ie/match.js":66,"../platforms/ie/rtc.js":67,"../platforms/node/attachStream.js":68,"../platforms/node/gum.js":69,"../platforms/node/match.js":70,"../platforms/node/rtc.js":71,"../platforms/react-native/attachStream.js":72,"../platforms/react-native/gum.js":73,"../platforms/react-native/match.js":74,"../platforms/react-native/rtc.js":75,"../platforms/safari/attachStream.js":76,"../platforms/safari/gum.js":77,"../platforms/safari/match.js":78,"../platforms/safari/rtc.js":79,"../platforms/unsupported/attachStream.js":80,"../platforms/unsupported/gum.js":81,"../platforms/unsupported/rtc.js":82}],4:[function(e,t,n){"use strict";var r=e("../temp-mock"),o=e("./index"),i=e("./isInstalled"),a=e("new-operator"),s=r({methods:["addIceCandidate","addStream","close","createAnswer","createDataChannel","createOffer","setLocalDescription","setRemoteDescription","removeStream","getLocalStreams","getRemoteStreams","getStats"],properties:["iceConnectionState","iceGatheringState","localDescription","remoteDescription","onaddstream","ondatachannel","onicecandidate","oniceconnectionstatechange","onnegotiationneeded","onremovestream","onsignalingstatechange","signalingState"]});i()?t.exports={RTCPeerConnection:function(){var e=a.apply(s,arguments);return o(function(t){r.resolve(e,t.RTCPeerConnection)}),e},RTCSessionDescription:function(){var e;if(o(function(t){e=t.RTCSessionDescription}),!e)throw new Error("Tried RTCSessionDescription before RTCPeerConnection");return a.apply(e,arguments)},RTCIceCandidate:function(){var e;if(o(function(t){e=t.RTCIceCandidate}),!e)throw new Error("Tried RTCIceCandidate before RTCPeerConnection");return a.apply(e,arguments)}}:t.exports={}},{"../temp-mock":10,"./index":8,"./isInstalled":9,"new-operator":33}],5:[function(e,t,n){"use strict";var r=e("crel");t.exports=function(e){var t=[{name:"onload",value:e.onLoad},{name:"pluginId",value:e.pluginId},{name:"windowless",value:!1},{name:"forceGetAllCams",value:!0},{name:"pageId",value:e.pageId}].map(r.bind(null,"param"));return r("object",{width:"1px",height:"1px",type:"application/x-temwebrtcplugin",id:e.pluginId},t)}},{crel:13}],6:[function(e,t,n){"use strict";var r=e("crel"),o=e("uuid");t.exports=function(e){var t=o.v4(),n=[{name:"pluginId",value:e.pluginId},{name:"windowless",value:!0},{name:"pageId",value:e.pageId},{name:"streamId",value:e.stream.id}].map(r.bind(null,"param"));return e.stream.enableSoundTracks(!e.muted),r("object",{type:"application/x-temwebrtcplugin",id:t},n)}},{crel:13,uuid:47}],7:[function(e,t,n){"use strict";function r(e,t,n,r){r||(r={}),n||(n={});var o=(n.iceServers||[]).map(function(e){return e.hasCredentials=!!e.credential,e});return e.PeerConnection(t,o,r.mandatory||null,r.optional||null)}function o(e,t){return t||(t={}),e.ConstructSessionDescription(t.type,t.sdp)}function i(e,t){return t||(t={}),e.ConstructIceCandidate(t.sdpMid||"",t.sdpMLineIndex,t.candidate)}t.exports=function(e,t){return{getUserMedia:e.getUserMedia,RTCPeerConnection:r.bind(null,e,t),RTCSessionDescription:o.bind(null,e),RTCIceCandidate:i.bind(null,e)}}},{}],8:[function(e,t,n){"use strict";function r(){i||s||(s=!0,window[w]=o,u(function(){i=m({pluginId:y,pageId:b,onLoad:w}),s=!1,d(document.body,i)}))}function o(){delete window[w],i.setPluginId(b,y),i.setLogFunction(console),i.setLogLevel("VERBOSE"),a=l(i,b),v.emit("ready",a)}var i,a,s,c=e("uuid"),u=e("domready"),d=e("crel"),f=e("lodash.merge"),p=e("events").EventEmitter,l=e("./getRTC"),m=e("./createPluginElement"),h=e("./createVideoElement"),g=e("./isInstalled"),v=new p,y=c.v4(),b=c.v4(),w="___$"+y;t.exports=function(e){return g()?a?void(e&&e(a)):(r(),void(e&&v.once("ready",e))):void(e&&e())},t.exports.createVideo=function(e,t){return t||(t={}),h(f({pluginId:y,pageId:b,stream:e},t))}},{"./createPluginElement":5,"./createVideoElement":6,"./getRTC":7,"./isInstalled":9,crel:13,domready:15,events:12,"lodash.merge":16,uuid:47}],9:[function(e,t,n){"use strict";function r(){var e=Array.prototype.slice.call(navigator.plugins);return e.reduce(function(e,t){return e[t.name]=t,e},{})}function o(e,t){try{return new ActiveXObject(e+"."+t),!0}catch(n){return!1}}var i="TemWebRTCPlugin",a="Tem";t.exports=function(){var t=e("detect-browser");return"safari"===t.name?r()[i]:"ie"===t.name?o(a,i):!1}},{"detect-browser":14}],10:[function(e,t,n){"use strict";function r(e){function t(){this._ctorArgs=arguments,this._actions=[],this._state={},this._opt=e}function n(e){t.prototype[e]=function(){return this._actions.push({type:"call",key:e,args:arguments}),this}}function r(e){Object.defineProperty(t.prototype,e,{configurable:!0,set:function(t){this._state[e]=t,this._actions.push({type:"set",key:e,value:t})},get:function(){return this._state[e]}})}return e||(e={}),e.properties||(e.properties=[]),e.methods||(e.methods=[]),e.properties.forEach(r),e.methods.forEach(n),t}r.resolve=function(e,t){var n=t.apply(t,e._ctorArgs);return"undefined"==typeof n&&(n={}),e._actions.forEach(function(t){"set"===t.type?n[t.key]=t.value:"call"===t.type&&"function"==typeof n[t.key]&&n[t.key].apply(e,t.args)}),e._opt.methods.forEach(function(t){e[t]=n[t]}),e._opt.properties.forEach(function(t){Object.defineProperty(e,t,{configurable:!0,set:function(e){n[t]=e},get:function(){return n[t]}})}),delete e._opt,delete e._state,delete e._actions,delete e._ctorArgs,n},t.exports=r},{}],11:[function(e,t,n){},{}],12:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),c=1;r>c;c++)i[c-1]=arguments[c];n.apply(this,i)}else if(a(n)){for(r=arguments.length,i=new Array(r-1),c=1;r>c;c++)i[c-1]=arguments[c];for(u=n.slice(),r=u.length,c=0;r>c;c++)u[c].apply(this,i)}return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned){var n;n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=i;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?o(e._events[t])?1:e._events[t].length:0}},{}],13:[function(t,n,r){!function(t,o){"object"==typeof r?n.exports=o():"function"==typeof e&&e.amd?e(o):t.crel=o()}(this,function(){function e(){var r,f=arguments,p=f[0],h=f[1],g=2,v=f.length,y=e[a];if(p=e[c](p)?p:u.createElement(p),1===v)return p;if((!d(h,n)||e[s](h)||l(h))&&(--g,h=null),v-g===1&&d(f[g],"string")&&void 0!==p[o])p[o]=f[g];else for(;v>g;++g)if(r=f[g],null!=r)if(l(r))for(var b=0;b<r.length;++b)m(p,r[b]);else m(p,r);for(var w in h)if(y[w]){var C=y[w];typeof C===t?C(p,h[w]):p[i](C,h[w])}else p[i](w,h[w]);return p}var t="function",n="object",r="nodeType",o="textContent",i="setAttribute",a="attrMap",s="isNode",c="isElement",u=typeof document===n?document:{},d=function(e,t){return typeof e===t},f=typeof Node===t?function(e){return e instanceof Node}:function(e){return e&&d(e,n)&&r in e&&d(e.ownerDocument,n)},p=function(t){return e[s](t)&&1===t[r]},l=function(e){return e instanceof Array},m=function(t,n){e[s](n)||(n=u.createTextNode(n)),t.appendChild(n)};return e[a]={},e[c]=p,e[s]=f,e})},{}],14:[function(e,t,n){function r(e){return e.concat(e[1].exec(navigator.userAgent))}function o(e){return!!e[2]}var i=[["edge",/Edge\/([0-9\._]+)/],["chrome",/Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/iPad\;\sCPU\sOS\s([0-9\._]+)/],["ios",/iPhone\;\sCPU\siPhone\sOS\s([0-9\._]+)/],["safari",/Safari\/([0-9\._]+)/]],a=0,s=[];for(a=0;a<i.length;a++)i[a]=r(i[a]),o(i[a])&&s.push(i[a]);for(var c=s[0],u=c&&c[3].split(/[._]/).slice(0,3);u&&u.length<3;)u.push("0");n.name=c&&c[0],n.version=u&&u.join(".")},{}],15:[function(t,n,r){!function(t,r){"undefined"!=typeof n?n.exports=r():"function"==typeof e&&"object"==typeof e.amd?e(r):this[t]=r()}("domready",function(){var e,t=[],n=document,r=n.documentElement.doScroll,o="DOMContentLoaded",i=(r?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return i||n.addEventListener(o,e=function(){for(n.removeEventListener(o,e),i=1;e=t.shift();)e()}),function(e){i?setTimeout(e,0):t.push(e)}})},{}],16:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function o(e,t,n,a,c){if(!u(e))return e;var d=s(t)&&(m(t)||g(t)),p=d?void 0:v(t);return f(p||t,function(s,u){if(p&&(u=s,s=t[u]),r(s))a||(a=[]),c||(c=[]),i(e,t,u,o,n,a,c);else{var f=e[u],l=n?n(f,s,u,e,t):void 0,m=void 0===l;m&&(l=s),void 0===l&&(!d||u in e)||!m&&(l===l?l===f:f!==f)||(e[u]=l)}}),e}function i(e,t,n,r,o,i,a){for(var c=i.length,u=t[n];c--;)if(i[c]==u)return void(e[n]=a[c]);var f=e[n],p=o?o(f,u,n,e,t):void 0,v=void 0===p;v&&(p=u,s(u)&&(m(u)||g(u))?p=m(f)?f:s(f)?d(f):[]:h(u)||l(u)?p=l(f)?y(f):h(f)?f:{}:v=!1),i.push(u),a.push(p),v?e[n]=r(p,u,o,i,a):(p===p?p!==f:f===f)&&(e[n]=p)}function a(e){return function(t){return null==t?void 0:t[e]}}function s(e){return null!=e&&c(w(e))}function c(e){return"number"==typeof e&&e>-1&&e%1==0&&b>=e}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var d=e("lodash._arraycopy"),f=e("lodash._arrayeach"),p=e("lodash._createassigner"),l=e("lodash.isarguments"),m=e("lodash.isarray"),h=e("lodash.isplainobject"),g=e("lodash.istypedarray"),v=e("lodash.keys"),y=e("lodash.toplainobject"),b=9007199254740991,w=a("length"),C=p(o);t.exports=C},{"lodash._arraycopy":17,"lodash._arrayeach":18,"lodash._createassigner":19,"lodash.isarguments":24,"lodash.isarray":25,"lodash.isplainobject":26,"lodash.istypedarray":28,"lodash.keys":29,"lodash.toplainobject":31}],17:[function(e,t,n){function r(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}t.exports=r},{}],18:[function(e,t,n){function r(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}t.exports=r},{}],19:[function(e,t,n){function r(e){return a(function(t,n){var r=-1,a=null==t?0:n.length,s=a>2?n[a-2]:void 0,c=a>2?n[2]:void 0,u=a>1?n[a-1]:void 0;for("function"==typeof s?(s=o(s,u,5),a-=2):(s="function"==typeof u?u:void 0,a-=s?1:0),c&&i(n[0],n[1],c)&&(s=3>a?void 0:s,a=1);++r<a;){var d=n[r];d&&e(t,d,s)}return t})}var o=e("lodash._bindcallback"),i=e("lodash._isiterateecall"),a=e("lodash.restparam");t.exports=r},{"lodash._bindcallback":20,"lodash._isiterateecall":21,"lodash.restparam":22}],20:[function(e,t,n){function r(e,t,n){if("function"!=typeof e)return o;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)};case 5:return function(n,r,o,i,a){return e.call(t,n,r,o,i,a)}}return function(){return e.apply(t,arguments)}}function o(e){return e}t.exports=r},{}],21:[function(e,t,n){function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&s(f(e))}function i(e,t){return e="number"==typeof e||u.test(e)?+e:-1,t=null==t?d:t,e>-1&&e%1==0&&t>e}function a(e,t,n){if(!c(n))return!1;var r=typeof t;if("number"==r?o(n)&&i(t,n.length):"string"==r&&t in n){var a=n[t];return e===e?e===a:a!==a}return!1}function s(e){return"number"==typeof e&&e>-1&&e%1==0&&d>=e}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=/^\d+$/,d=9007199254740991,f=r("length");t.exports=a},{}],22:[function(e,t,n){function r(e,t){if("function"!=typeof e)throw new TypeError(o);return t=i(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,r=-1,o=i(n.length-t,0),a=Array(o);++r<o;)a[r]=n[t+r];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=Array(t+1);for(r=-1;++r<t;)s[r]=n[r];return s[t]=a,e.apply(this,s)}}var o="Expected a function",i=Math.max;t.exports=r},{}],23:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return s(n)?n:void 0}function i(e){return a(e)&&l.call(e)==c}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function s(e){return null==e?!1:i(e)?m.test(f.call(e)):r(e)&&u.test(e)}var c="[object Function]",u=/^\[object .+?Constructor\]$/,d=Object.prototype,f=Function.prototype.toString,p=d.hasOwnProperty,l=d.toString,m=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=o},{}],24:[function(e,t,n){(function(e){function n(e){return function(t){return null==t?void 0:t[e]}}function r(e){return i(e)&&h.call(e,"callee")&&(!v.call(e,"callee")||g.call(e)==f)}function o(e){return null!=e&&!("function"==typeof e&&a(e))&&s(y(e))}function i(e){return u(e)&&o(e)}function a(e){var t=c(e)?g.call(e):"";return t==p||t==l}function s(e){return"number"==typeof e&&e>-1&&e%1==0&&d>=e}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function u(e){return!!e&&"object"==typeof e}var d=9007199254740991,f="[object Arguments]",p="[object Function]",l="[object GeneratorFunction]",m=e.Object.prototype,h=m.hasOwnProperty,g=m.toString,v=m.propertyIsEnumerable,y=n("length");t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return c(n)?n:void 0}function i(e){return"number"==typeof e&&e>-1&&e%1==0&&y>=e}function a(e){return s(e)&&h.call(e)==d}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return null==e?!1:a(e)?g.test(l.call(e)):r(e)&&f.test(e)}var u="[object Array]",d="[object Function]",f=/^\[object .+?Constructor\]$/,p=Object.prototype,l=Function.prototype.toString,m=p.hasOwnProperty,h=p.toString,g=RegExp("^"+l.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=o(Array,"isArray"),y=9007199254740991,b=v||function(e){return r(e)&&i(e.length)&&h.call(e)==u};t.exports=b},{}],26:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function o(e,t){return a(e,t,c)}function i(e){var t;if(!r(e)||p.call(e)!=u||s(e)||!f.call(e,"constructor")&&(t=e.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var n;return o(e,function(e,t){n=t}),void 0===n||f.call(e,n)}var a=e("lodash._basefor"),s=e("lodash.isarguments"),c=e("lodash.keysin"),u="[object Object]",d=Object.prototype,f=d.hasOwnProperty,p=d.toString;t.exports=i},{"lodash._basefor":27,"lodash.isarguments":24,"lodash.keysin":30}],27:[function(e,t,n){function r(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++o];if(n(i[c],c,i)===!1)break}return t}}var o=r();t.exports=o},{}],28:[function(e,t,n){(function(e){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&i>=e}function r(e){return!!e&&"object"==typeof e}function o(e){return r(e)&&n(e.length)&&!!P[k.call(e)]}var i=9007199254740991,a="[object Arguments]",s="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Function]",p="[object Map]",l="[object Number]",m="[object Object]",h="[object RegExp]",g="[object Set]",v="[object String]",y="[object WeakMap]",b="[object ArrayBuffer]",w="[object Float32Array]",C="[object Float64Array]",_="[object Int8Array]",S="[object Int16Array]",j="[object Int32Array]",T="[object Uint8Array]",x="[object Uint8ClampedArray]",R="[object Uint16Array]",E="[object Uint32Array]",P={};P[w]=P[C]=P[_]=P[S]=P[j]=P[T]=P[x]=P[R]=P[E]=!0,P[a]=P[s]=P[b]=P[c]=P[u]=P[d]=P[f]=P[p]=P[l]=P[m]=P[h]=P[g]=P[v]=P[y]=!1;var I=e.Object.prototype,k=I.toString;t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(e,t,n){function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&a(y(e))}function i(e,t){return e="number"==typeof e||l.test(e)?+e:-1,t=null==t?v:t,e>-1&&e%1==0&&t>e}function a(e){return"number"==typeof e&&e>-1&&e%1==0&&v>=e}function s(e){for(var t=u(e),n=t.length,r=n&&e.length,o=!!r&&a(r)&&(p(e)||f(e)),s=-1,c=[];++s<n;){var d=t[s];(o&&i(d,r)||h.call(e,d))&&c.push(d)}return c}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function u(e){if(null==e)return[];c(e)||(e=Object(e));var t=e.length;t=t&&a(t)&&(p(e)||f(e))&&t||0;for(var n=e.constructor,r=-1,o="function"==typeof n&&n.prototype===e,s=Array(t),u=t>0;++r<t;)s[r]=r+"";for(var d in e)u&&i(d,t)||"constructor"==d&&(o||!h.call(e,d))||s.push(d);return s}var d=e("lodash._getnative"),f=e("lodash.isarguments"),p=e("lodash.isarray"),l=/^\d+$/,m=Object.prototype,h=m.hasOwnProperty,g=d(Object,"keys"),v=9007199254740991,y=r("length"),b=g?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&o(e)?s(e):c(e)?g(e):[]}:s;t.exports=b},{"lodash._getnative":23,"lodash.isarguments":24,"lodash.isarray":25}],30:[function(e,t,n){function r(e,t){return e="number"==typeof e||u.test(e)?+e:-1,t=null==t?p:t,e>-1&&e%1==0&&t>e}function o(e){return"number"==typeof e&&e>-1&&e%1==0&&p>=e}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){if(null==e)return[];i(e)||(e=Object(e));var t=e.length;t=t&&o(t)&&(c(e)||s(e))&&t||0;for(var n=e.constructor,a=-1,u="function"==typeof n&&n.prototype===e,d=Array(t),p=t>0;++a<t;)d[a]=a+"";for(var l in e)p&&r(l,t)||"constructor"==l&&(u||!f.call(e,l))||d.push(l);return d}var s=e("lodash.isarguments"),c=e("lodash.isarray"),u=/^\d+$/,d=Object.prototype,f=d.hasOwnProperty,p=9007199254740991;t.exports=a},{"lodash.isarguments":24,"lodash.isarray":25}],31:[function(e,t,n){function r(e){return o(e,i(e))}var o=e("lodash._basecopy"),i=e("lodash.keysin");t.exports=r},{"lodash._basecopy":32,"lodash.keysin":30}],32:[function(e,t,n){function r(e,t,n){n||(n={});for(var r=-1,o=t.length;++r<o;){var i=t[r];n[i]=e[i]}return n}t.exports=r},{}],33:[function(e,t,n){"use strict";t.exports=function(){if(1===arguments.length)return new this(arguments[0]);if(2===arguments.length)return new this(arguments[0],arguments[1]);if(3===arguments.length)return new this(arguments[0],arguments[1],arguments[2]);if(4===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3]);if(5===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);if(6===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);if(7===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);if(8===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);if(9===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);if(10===arguments.length)return new this(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);var e=Object.create(this.prototype),t=this.apply(e,arguments);return"object"==typeof t&&null!==t?t:e}},{}],34:[function(e,t,n){"use strict";t.exports.RTCIceCandidate=e("./rtcicecandidate"),t.exports.RTCPeerConnection=e("./rtcpeerconnection"),t.exports.RTCSessionDescription=e("./rtcsessiondescription")},{"./rtcicecandidate":37,"./rtcpeerconnection":38,"./rtcsessiondescription":40}],35:[function(e,t,n){"use strict";function r(e,t,n,o,i,a,s,c,u,d){if(!(this instanceof r))return new r(e,t,n,o,i,a,s,c,u,d);var f=!1;e=e||"0.0.0.0",s="number"==typeof s?s:9,c="boolean"==typeof c?c:!0,u=u||null,d=d||null,Object.defineProperties(this,{_address:{get:function(){return e},set:function(t){e=t}},_candidates:{value:[]},_port:{get:function(){return s},set:function(e){s=e}},_rejected:{get:function(){return f},set:function(e){f=e}},_streamId:{get:function(){return u},set:function(e){u=e}},_track:{get:function(){return d},set:function(e){d=e}},_triples:{value:new Set},candidates:{enumerable:!0,get:function(){return this._candidates.slice()}},capabilities:{enumerable:!0,value:n},defaultCandidate:{enumerable:!0,get:function(){return this._candidates.length?this._candidates[0]:null}},direction:{enumerable:!0,value:o},kind:{enumerable:!0,value:i},port:{enumerable:!0,get:function(){return s}},rtcpMux:{enumerable:!0,value:c},streamId:{enumerable:!0,get:function(){return u}},track:{enumerable:!0,get:function(){return d}}}),t&&t.forEach(this.addCandidate,this)}r.prototype.addCandidate=function(e){var t=[e.ip,e.port,e.protocol].join(" ");return this._triples.has(t)?!1:(this._triples.add(t),this._candidates.push(e),!0)},r.prototype.copy=function(e,t,n,o,i,a,s){return new r(this.address,t,n||this.capabilities,o||this.direction,this.kind,this.mid,i,this.rtcpMux,a,s)},r.prototype.copyAndReject=function(){var e=new r(null,this.candidates,this.capabilities,this.direction,this.kind,this.mid,null,this.rtcpMux);return e.reject()},r.prototype.reject=function(){return this.setPort(0),this},r.prototype.setAddress=function(e){return this._address=e,this},r.prototype.setPort=function(e){return this._port=e,this},t.exports=r},{}],36:[function(e,t,n){"use strict";function r(e,t){return this instanceof r?(Event.call(this,e,t),void Object.defineProperties(this,{stream:{enumerable:!0,value:t.stream}})):new r(e,t)}t.exports=r},{}],37:[function(e,t,n){"use strict";function r(e){return this instanceof r?void Object.defineProperties(this,{candidate:{enumerable:!0,value:e.candidate},sdpMLineIndex:{enumerable:!0,value:e.sdpMLineIndex}}):new r(e)}t.exports=r},{}],38:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);var t=a(e),n=new RTCIceGatherer(t),o=!1;n.onlocalcandidate=this._onlocalcandidate.bind(this);var i=null,s=!1,c=0,u=new RTCIceTransport,d=null;u.onicestatechange=this._onicestatechange.bind(this);var f=new RTCDtlsTransport(u);f.ondtlsstatechange=this._ondtlsstatechange.bind(this);var p="stable",l=null,m=null,h=null,g=null;Object.defineProperties(this,{_dtlsTransport:{value:f},_dtmfSenders:{value:new Map},_gatherOptions:{value:t},_iceCandidatesAdded:{get:function(){return c},set:function(e){c=e}},_iceGatherer:{value:n},_iceGatheringCompleted:{get:function(){return o},set:function(e){o=e}},_iceTransport:{value:u},_localCandidates:{value:new Set},_localDescription:{get:function(){return m},set:function(e){m=e}},_localStreams:{value:[]},_midCounters:{value:{audio:0,video:0}},_remoteCandidates:{value:new Set},_remoteDescription:{get:function(){return h},set:function(e){h=e}},_remoteStreams:{value:[]},_rtpReceivers:{value:new Map},_rtpSenders:{value:new Map},_signalingState:{get:function(){return p},set:function(e){p=e,this.onsignalingstatechange&&this.onsignalingstatechange()}},_streamIds:{value:new Map},iceConnectionState:{enumerable:!0,get:function(){return u.state}},iceGatheringState:{enumerable:!0,get:function(){return o?"gathering":"complete"}},localDescription:{enumerable:!0,get:function(){return m}},onaddstream:{enumerable:!0,get:function(){return g},set:function(e){g=e}},onicecandidate:{enumerable:!0,get:function(){return i},set:function(e){if(i=e,!s)try{n.getLocalCandidates().forEach(n.onlocalcandidate)}catch(t){}s=!0}},oniceconnectionstatechange:{enumerable:!0,get:function(){return d},set:function(e){d=e}},onsignalingstatechange:{enumerable:!0,get:function(){return l},set:function(e){l=e}},remoteDescription:{enumerable:!0,get:function(){return h}},signalingState:{enumerable:!0,get:function(){return p}}})}function o(e){return new Error("Invalid signaling state: "+e)}function i(e){return!Object.keys(e).length}function a(e){var t=(e.iceServers||[]).filter(function(e){return!e.urls.match(/^stun:/)});return{gatherPolicy:e.gatherPolicy||"all",iceServers:t}}function s(e){return new l("addstream",{stream:e})}function c(e){return new h("icecandidate",{candidate:e})}function u(e){if(!e)return{};var t=e.candidate.indexOf("candidate:"),n=e.candidate.slice(t+10).replace(/ +/g," ").split(" "),r={foundation:n[0],protocol:n[2],priority:parseInt(n[3]),ip:n[4],port:parseInt(n[5]),type:n[7],relatedAddress:null,relatedPort:0,tcpType:"active"};return"host"!==r.type&&(r.relatedAddress=n[9],r.relatedPort=parseInt(n[11])),r}function d(e){if(i(e))return null;var t=["a=candidate",e.foundation,1,e.protocol,e.priority,e.ip,e.port,e.type];return e.relatedAddress&&(t=t.concat(["raddr",e.relatedAddress,"rport",e.relatedPort])),t.push("generation 0"),new m({candidate:t.join(" "),sdpMLineIndex:0})}function f(e,t){var n=[];return e.forEach(function(e){t.forEach(function(t){e.name===t.name&&e.clockRate===t.clockRate&&e.numChannels===t.numChannels&&n.push(t)})}),n}var p=e("./mediasection"),l=e("./mediastreamevent"),m=e("./rtcicecandidate"),h=e("./rtcpeerconnectioniceevent"),g=e("./rtcsessiondescription"),v=e("sdp-transform"),y=e("./sdp-utils");r.prototype._makeMid=function(e){return e+ ++this._midCounters[e]},r.prototype._ondtlsstatechange=function(e){},r.prototype._onicestatechange=function(e){
this.oniceconnectionstatechange&&this.oniceconnectionstatechange(e)},r.prototype._onlocalcandidate=function(e){if(i(e.candidate)&&(this._iceGatheringCompleted=!0),this._localCandidates.add(e.candidate),this.onicecandidate){var t=d(e.candidate);this.onicecandidate(c(t))}},r.prototype._sendRtp=function(e){var t=e.kind;return this._rtpSenders.forEach(function(n){n.track.kind===t&&n.send(e.capabilities)},this),this},r.prototype._sendAndReceiveRtp=function(e){return e.forEach(function(e){("sendrecv"===e.direction||"sendonly"===e.direction)&&this._sendRtp(e),("sendrecv"===e.direction||"recvonly"===e.direction)&&this._receiveRtp(e)},this),this},r.prototype._receiveRtp=function(e){var t=e.capabilities.type,n=new RTCRtpReceiver(this._dtlsTransport,t);n.receive(e.capabilities);var r=n.track;this._rtpReceivers.set(r,n);var o=new MediaStream;return o.addTrack(r),this._remoteStreams.push(o),this.onaddstream&&this.onaddstream(s(o)),this},r.prototype._startDtlsTransport=function(e){return this._dtlsTransport.start(e),this},r.prototype._startIceTransport=function(e){var t="have-local-offer"===this.signalingState?"controlling":"controlled";return this._iceTransport.start(this._iceGatherer,e,t),this},r.prototype.addIceCandidate=function(e,t,n){this._iceCandidatesAdded++;var r=u(e),o=[r.ip,r.port,r.transport].join(" ");this._remoteCandidates.has(o)||(this._remoteCandidates.add(o),this._iceTransport.addRemoteCandidate(r)),t&&t()},r.prototype.addStream=function(e){this._localStreams.push(e),e.getTracks().forEach(function(t){var n=new RTCRtpSender(t,this._dtlsTransport);this._rtpSenders.set(t,n),this._streamIds.set(t,e.id)},this)},r.prototype.close=function(){this._signalingState="closed",this._rtpReceivers.forEach(function(e){e.stop()}),this._dtlsTransport.stop(),this._iceTransport.stop()},r.prototype.createAnswer=function(e,t){if("have-remote-offer"!==this.signalingState)return void t(o(this.signalingState));var n=y.parseDescription(this.remoteDescription),r=this.getLocalStreams(),i={audio:[],video:[]};r.forEach(function(e){i.audio=i.audio.concat(e.getAudioTracks()),i.video=i.video.concat(e.getVideoTracks())});var a=n.mediaSections.map(function(e){var t,n,r=e.kind,o=e.direction,a=e.capabilities,s=RTCRtpSender.getCapabilities(r),c=f(a.codecs,s.codecs),u={codecs:c},d=u;if(!c.length)return e.copyAndReject();"inactive"===o||"recvonly"===o&&!i[r].length?t="inactive":"recvonly"===o?(n=i[r].shift(),t="sendonly"):"sendrecv"===o?(n=i[r].shift(),t=n?"sendrecv":"recvonly"):t="recvonly";var p=this._streamIds.get(n),l=e.copy(null,null,d,t,null,p,n);return l},this);a.forEach(function(e){this._localCandidates.forEach(e.addCandidate,e)},this);var s=y.makeInitialSDPBlob();y.addMediaSectionsToSDPBlob(s,a),y.addIceParametersToSDPBlob(s,this._iceGatherer.getLocalParameters()),y.addDtlsParametersToSDPBlob(s,this._dtlsTransport.getLocalParameters());var c=new g({sdp:v.write(s),type:"answer"});e(c)},r.prototype.createDTMFSender=function(e){if(!this._dtmfSenders.has(e)){var t=this._rtpSenders.get(e),n=new RTCDtmfSender(t);this._dtmfSenders.set(e,n)}return this._dtmfSenders.get(e)},r.prototype.createOffer=function(e,t,n){var r={audio:null,video:null},o={audio:0,video:0};n=n||{},["optional","mandatory"].forEach(function(e){e in n&&("OfferToReceiveAudio"in n[e]&&(r.audio=Number(n[e].OfferToReceiveAudio)),"OfferToReceiveVideo"in n[e]&&(r.video=Number(n[e].OfferToReceiveVideo)))});var i=[],a={audio:r.audio,video:r.video},s=this.getLocalStreams();s.forEach(function(e){var t=e.getAudioTracks(),n=e.getVideoTracks();o.audio+=t.length,o.video+=n.length;var r=t.concat(n);r.forEach(function(t){var n,r=t.kind,o=RTCRtpSender.getCapabilities(r),s=this._makeMid(r);null===a.audio?n="sendrecv":a[r]?(a[r]--,n="sendrecv"):n="sendonly";var c=new p(null,null,o,n,r,s,null,null,e.id,t);i.push(c)},this)},this),["audio","video"].forEach(function(e){var t=Math.max(r[e]-o[e],0);if(t)for(var n,a,s=RTCRtpSender.getCapabilities(e),c="recvonly";t--;)n=this._makeMid(e),a=new p(null,null,s,c,e,n),i.push(a)},this),i.forEach(function(e){this._localCandidates.forEach(e.addCandidate,e)},this);var c=y.makeInitialSDPBlob();y.addMediaSectionsToSDPBlob(c,i),y.addIceParametersToSDPBlob(c,this._iceGatherer.getLocalParameters()),y.addDtlsParametersToSDPBlob(c,this._dtlsTransport.getLocalParameters());var u=new g({sdp:v.write(c),type:"offer"});e(u)},r.prototype.getLocalStreams=function(){return this._localStreams.slice()},r.prototype.getRemoteStreams=function(){return this._remoteStreams.slice()},r.prototype.setLocalDescription=function(e,t,n){var r;switch(this.signalingState){case"stable":r="have-local-offer";break;case"have-remote-offer":r="stable";break;default:return void n(o(this.signalingState))}var i=y.parseDescription(e);"have-remote-offer"===this.signalingState&&this._sendAndReceiveRtp(i.mediaSections),this._localDescription=e,this._signalingState=r,t()},r.prototype.setRemoteDescription=function(e,t,n){var r;switch(this.signalingState){case"stable":r="have-remote-offer";break;case"have-local-offer":r="stable";break;default:return void n(o(this.signalingState))}var i=y.parseDescription(e);i.mediaSections.forEach(function(e){e.candidates.forEach(this._iceTransport.addRemoteCandidate,this._iceTransport)},this),this._startIceTransport(i.iceParameters[0]),this._startDtlsTransport(i.dtlsParameters[0]),"have-local-offer"===this.signalingState&&this._sendAndReceiveRtp(i.mediaSections),this._remoteDescription=e,this._signalingState=r,t()},t.exports=r},{"./mediasection":35,"./mediastreamevent":36,"./rtcicecandidate":37,"./rtcpeerconnectioniceevent":39,"./rtcsessiondescription":40,"./sdp-utils":41,"sdp-transform":43}],39:[function(e,t,n){"use strict";function r(e,t){return this instanceof r?(Event.call(this,e,t),void Object.defineProperties(this,{candidate:{enumerable:!0,value:t.candidate}})):new r(e,t)}t.exports=r},{}],40:[function(e,t,n){"use strict";function r(e){return this instanceof r?void Object.defineProperties(this,{sdp:{enumerable:!0,value:e.sdp},type:{enumerable:!0,value:e.type}}):new r(e)}t.exports=r},{}],41:[function(e,t,n){"use strict";function r(e,t,n){return e=e||{},e.candidates=e.candidates||[],t?(t.forEach(function(t){if(!t.foundation)return void(e.endOfCandidates="end-of-candidates");var r={foundation:t.foundation,transport:t.protocol,priority:t.priority,ip:t.ip,port:t.port,type:t.type,generation:0};if(t.relatedAddress&&(r.raddr=t.relatedAddress,r.rport=t.relatedPort),"number"==typeof n)return r.component=n,void e.candidates.push(r);r.component=1,e.candidates.push(r);var o={};for(var i in r)o[i]=r[i];o.component=2,e.candidates.push(o)}),e):e}function o(e,t,n){return e=e||{},e.media?(e.media.forEach(function(e){r(e,t,n)}),e):e}function i(e,t,n){return e=e||{},o(e,t,n),e}function a(e,t){return e=e||{},c(e,t),e}function s(e,t){e=e||{};var n=t.fingerprints;return n.length&&(e.fingerprint={type:n[0].algorithm,hash:n[0].value}),e}function c(e,t){return e=e||{},e.media?(e.media.forEach(function(e){s(e,t)}),e):e}function u(e,t){return e=e||{},d(e,t),e}function d(e,t){return e=e||{},e.media?(e.media.forEach(function(e){f(e,t)}),e):e}function f(e,t){return e=e||{},e.iceUfrag=t.usernameFragment,e.icePwd=t.password,e}function p(e,t){var n=t.streamId;n&&(e.msidSemantic=e.msidSemantic||{semantic:"WMS",token:[]},e.msidSemantic.token.push(n));var o=t.mid;if(o){e.groups=e.groups||[];var i=!1;e.groups.forEach(function(e){"BUNDLE"===e.type&&(e.mids.push(o),i=!0)}),i||e.groups.push({type:"BUNDLE",mids:[o]})}var a=[],s=[],c=[];t.capabilities.codecs.forEach(function(e){var t=e.preferredPayloadType;a.push(t);var n={payload:t,codec:e.name,rate:e.clockRate};switch(e.numChannels>1&&(n.encoding=e.numChannels),s.push(n),e.name){case"telephone-event":e.parameters&&e.parameters.events&&c.push({payload:t,config:e.parameters.events})}});var u=[];if(n&&t.track){var d=Math.floor(4294967296*Math.random()),f=g(),p=t.track.id;u=u.concat([{id:d,attribute:"cname",value:f},{id:d,attribute:"msid",value:t.streamId+" "+p},{id:d,attribute:"mslabel",value:p},{id:d,attribute:"label",value:p}])}var l=t.defaultCandidate,m={rtp:s,fmtp:c,type:t.kind,port:l?l.port:9,payloads:a.join(" "),protocol:"RTP/SAVPF",direction:t.direction,connection:{version:4,ip:l?l.ip:"0.0.0.0"},rtcp:{port:l?l.port:9,netType:"IN",ipVer:4,address:l?l.ip:"0.0.0.0"},ssrcs:u};return o&&(m.mid=o),t.rtcpMux&&(m.rtcpMux="rtcp-mux"),r(m,t.candidates),e.media.push(m),e}function l(e,t){return t.forEach(p.bind(null,e)),e}function m(e){return e=e||Math.floor(4294967296*Math.random()),{version:0,origin:{username:"-",sessionId:e,sessionVersion:0,netType:"IN",ipVer:4,address:"127.0.0.1"},name:"-",timing:{start:0,stop:0},connection:{version:4,ip:"0.0.0.0"},media:[]}}function h(e){var t=y.parse(e.sdp),n=[],r=[],o=[],i=[],a=[t];return t.media&&(a=a.concat(t.media)),a.forEach(function(e){if(e.iceUfrag&&e.icePwd&&e.fingerprint&&(n.push({usernameFragment:e.iceUfrag,password:e.icePwd}),r.push({fingerprints:[{algorithm:e.fingerprint.type,value:e.fingerprint.hash}]})),e.rtp){if("video"===e.type)return;var t,a,s,c=e.connection?e.connection.ip:null,u=e.direction,d=e.type,f=e.mid,p=e.port||null,l="rtcp-mux"===e.rtcpMux;(e.ssrcs||[]).forEach(function(e){switch(e.attribute){case"cname":a=e.id,t=e.value;break;case"label":case"mslabel":a=e.id;break;case"msid":a=e.id,s=e.value.split(" ")[0]}});var m={type:d,muxId:f,codecs:e.rtp.map(function(e){var t={name:e.codec,payloadType:parseInt(e.payload),clockRate:parseInt(e.rate),numChannels:e.encoding||1,rtcpFeedback:[],parameters:{}};switch(e.codec){case"telephone-event":t.parameters.events="0-16"}return t}),headerExtensions:[],encodings:e.rtp.map(function(e){return{ssrc:a,codecPayloadType:parseInt(e.payload),active:!0}}),rtcp:{ssrc:a,cname:t,mux:l}},h=new v(c,o,m,u,d,f,p,l,s);(e.candidates||[]).forEach(function(e){var t={foundation:String(e.foundation),protocol:e.transport,priority:e.priority,ip:e.ip,port:e.port,type:e.type,relatedAddress:e.raddr,relatedPort:e.rport};o.push(t),h.addCandidate(t)}),"end-of-candidates"===e.endOfCandidates&&h.addCandidate({}),i.push(h)}}),{iceParameters:n,dtlsParameters:r,mediaSections:i}}function g(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/".split(""),t=16,n="";t--;)n+=e[Math.floor(Math.random()*e.length)];return n}var v=e("./mediasection"),y=e("sdp-transform");t.exports.addCandidatesToSDPBlob=i,t.exports.addDtlsParametersToSDPBlob=a,t.exports.addIceParametersToSDPBlob=u,t.exports.addMediaSectionsToSDPBlob=l,t.exports.makeInitialSDPBlob=m,t.exports.parseDescription=h},{"./mediasection":35,"sdp-transform":43}],42:[function(e,t,n){var r=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(r).forEach(function(e){var t=r[e];t.forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},{}],43:[function(e,t,n){var r=e("./parser"),o=e("./writer");n.write=o,n.parse=r.parse,n.parseFmtpConfig=r.parseFmtpConfig,n.parsePayloads=r.parsePayloads,n.parseRemoteCandidates=r.parseRemoteCandidates},{"./parser":44,"./writer":45}],44:[function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,n,o){if(o&&!n)t[o]=r(e[1]);else for(var i=0;i<n.length;i+=1)null!=e[i+1]&&(t[n[i]]=r(e[i+1]))},i=function(e,t,n){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:r?t[e.name]:t;o(n.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i)},a=e("./grammar"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(o))return i(c,r,o)}}),t.media=n,t};var c=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=r(n[1])),e};n.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(c,{})},n.parsePayloads=function(e){return e.split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),o=0;o<n.length;o+=3)t.push({component:n[o],ip:n[o+1],port:n[o+2]});return t}},{"./grammar":42}],45:[function(e,t,n){var r=e("./grammar"),o=/%[sdv%]/g,i=function(e){var t=1,n=arguments,r=n.length;return e.replace(o,function(e){if(t>=r)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},a=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,o=[e+"="+r];if(t.names)for(var a=0;a<t.names.length;a+=1){var s=t.names[a];t.name?o.push(n[t.name][s]):o.push(n[t.names[a]])}else o.push(n[t.name]);return i.apply(null,o)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,o=t.innerOrder||c,i=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(a(t,n,e))})})}),e.media.forEach(function(e){i.push(a("m",r.m[0],e)),o.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(a(t,n,e))})})})}),i.join("\r\n")+"\r\n"}},{"./grammar":42}],46:[function(e,t,n){(function(e){var n;if(e.crypto&&crypto.getRandomValues){var r=new Uint8Array(16);n=function(){return crypto.getRandomValues(r),r}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],47:[function(e,t,n){function r(e,t,n){var r=t&&n||0,o=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>o&&(t[r+o++]=u[e])});16>o;)t[r+o++]=0;return t}function o(e,t){var n=t||0,r=c;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function i(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:l,s=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:h+1,u=s-m+(c-h)/1e4;if(0>u&&void 0===e.clockseq&&(a=a+1&16383),(0>u||s>m)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=s,h=c,l=a,s+=122192928e5;var d=(1e4*(268435455&s)+c)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var f=s/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var g=e.node||p,v=0;6>v;v++)i[r+v]=g[v];return t?t:o(i)}function a(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;16>a;a++)t[r+a]=i[a];return t||o(i)}for(var s=e("./rng"),c=[],u={},d=0;256>d;d++)c[d]=(d+256).toString(16).substr(1),u[c[d]]=d;var f=s(),p=[1|f[0],f[1],f[2],f[3],f[4],f[5]],l=16383&(f[6]<<8|f[7]),m=0,h=0,g=a;g.v1=i,g.v4=a,g.parse=r,g.unparse=o,t.exports=g},{"./rng":46}],48:[function(e,t,n){"use strict";t.exports=function(){var e=window.URL||window.webkitURL;return function(t,n){return n.src=e.createObjectURL(t),n}}},{}],49:[function(e,t,n){"use strict";t.exports=function(e){return function(t,n){function r(t){t._rtcOpt=e,n(null,t)}function o(e){n(e)}var i=navigator.getUserMedia||navigator.webkitGetUserMedia;if(!i)throw new Error("Failed to find getUserMedia");2!==arguments.length&&(n=t,t={video:!0,audio:!0}),i.call(navigator,t,r,o)}}},{}],50:[function(e,t,n){"use strict";t.exports=function(){var t=e("detect-browser");return"undefined"!=typeof window&&"undefined"!=typeof window.chrome&&"chrome"===t.name}},{"detect-browser":14}],51:[function(e,t,n){"use strict";t.exports=function(){return{RTCPeerConnection:window.RTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.webkitRTCIceCandidate}}},{}],52:[function(e,t,n){"use strict";function r(){throw new Error("Missing iosrtc plugin for attachStream")}t.exports=function(){var e=window.URL||window.webkitURL;return function(t,n){return"undefined"==typeof cordova?r():"undefined"==typeof cordova.plugins?r():"undefined"==typeof cordova.plugins.iosrtc?r():(n.src=e.createObjectURL(t),n.setAttribute("webkit-playsinline","true"),cordova.plugins.iosrtc.observeVideo(n),n)}}},{}],53:[function(e,t,n){"use strict";function r(){throw new Error("Missing iosrtc plugin for getUserMedia")}t.exports=function(e){return function(t,n){function o(t){t._rtcOpt=e,n(null,t)}function i(e){n(e)}return"undefined"==typeof cordova?r():"undefined"==typeof cordova.plugins?r():"undefined"==typeof cordova.plugins.iosrtc?r():(2!==arguments.length&&(n=t,t={video:!0,audio:!0}),void cordova.plugins.iosrtc.getUserMedia(t,o,i))}}},{}],54:[function(e,t,n){"use strict";t.exports=function(){return"undefined"!=typeof cordova&&"iOS"===window.device.platform}},{}],55:[function(e,t,n){"use strict";function r(){throw new Error("Missing iosrtc plugin for RTCPeerConnection")}t.exports=function(){return"undefined"==typeof cordova?r():"undefined"==typeof cordova.plugins?r():"undefined"==typeof cordova.plugins.iosrtc?r():{RTCPeerConnection:cordova.plugins.iosrtc.RTCPeerConnection,RTCSessionDescription:cordova.plugins.iosrtc.RTCSessionDescription,RTCIceCandidate:cordova.plugins.iosrtc.RTCIceCandidate}}},{}],56:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){return t.srcObject=e,t}}},{}],57:[function(e,t,n){"use strict";t.exports=function(e){return function(t,n){function r(t){t._rtcOpt=e,n(null,t)}function o(e){n(e)}var i=navigator.getUserMedia||navigator.msGetUserMedia;if(!i)throw new Error("Failed to find getUserMedia");2!==arguments.length&&(n=t,t={video:!0,audio:!0}),i.call(navigator,t,r,o)}}},{}],58:[function(e,t,n){"use strict";t.exports=function(){var t=e("detect-browser");return"edge"===t.name&&window.RTCIceGatherer}},{"detect-browser":14}],59:[function(e,t,n){"use strict";function r(e){return{label:e,send:function(){},close:function(){}}}t.exports=function(){var t=e("ortc-adapter");return t.RTCPeerConnection.prototype.createDataChannel=r,{RTCPeerConnection:t.RTCPeerConnection,RTCSessionDescription:t.RTCSessionDescription,RTCIceCandidate:t.RTCIceCandidate}}},{"ortc-adapter":34}],60:[function(e,t,n){arguments[4][56][0].apply(n,arguments)},{dup:56}],61:[function(e,t,n){"use strict";t.exports=function(e){return function(t,n){function r(t){t._rtcOpt=e,n(null,t)}function o(e){n(e)}var i=navigator.getUserMedia||navigator.mozGetUserMedia;if(!i)throw new Error("Failed to find getUserMedia");2!==arguments.length&&(n=t,t={video:!0,audio:!0}),i.call(navigator,t,r,o)}}},{}],62:[function(e,t,n){"use strict";t.exports=function(){var t=e("detect-browser");return"firefox"===t.name}},{"detect-browser":14}],63:[function(e,t,n){"use strict";t.exports=function(){return{RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate}}},{}],64:[function(e,t,n){"use strict";t.exports=function(){var t=e("../../lib/copyStyle"),n=e("../../lib/temasys");return function(e,r){var o=n.createVideo(e,{muted:Boolean(r.muted)});t(r,o);var i=r.parentNode;return i&&(i.insertBefore(o),i.removeChild(r)),o}}},{"../../lib/copyStyle":2,"../../lib/temasys":8}],65:[function(e,t,n){"use strict";t.exports=function(t){var n=e("../../lib/temasys");return n(),function(e,r){function o(e){e._rtcOpt=t,r(null,e)}function i(e){r(e)}2!==arguments.length&&(r=e,e={video:!0,audio:!0}),n(function(t){if(!t||!t.getUserMedia)throw new Error("Failed to find getUserMedia");t.getUserMedia(e,o,i)})}}},{"../../lib/temasys":8}],66:[function(e,t,n){"use strict";t.exports=function(){var t=e("detect-browser");return"ie"===t.name}},{"detect-browser":14}],67:[function(e,t,n){"use strict";t.exports=function(){var t=e("../../lib/temasys/MockRTC");return t}},{"../../lib/temasys/MockRTC":4}],68:[function(e,t,n){"use strict";t.exports=e("../unsupported/attachStream")},{"../unsupported/attachStream":80}],69:[function(e,t,n){"use strict";t.exports=e("../unsupported/gum")},{"../unsupported/gum":81}],70:[function(e,t,n){"use strict";t.exports=function(){return"undefined"==typeof window}},{}],71:[function(e,t,n){"use strict";t.exports=function(){var t;try{t=e("wrtc")}catch(n){return{}}return{RTCPeerConnection:t.RTCPeerConnection,RTCSessionDescription:t.RTCSessionDescription,RTCIceCandidate:t.RTCIceCandidate}}},{wrtc:11}],72:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){}}},{}],73:[function(e,t,n){"use strict";t.exports=function(t){var n;try{n=e("react-native-webrtc")}catch(r){throw new Error("Missing react-native-webrtc!")}return function(e,n){function r(e){e._rtcOpt=t,n(null,e)}function o(e){n(e)}var i=navigator.getUserMedia;if(!i)throw new Error("Failed to find getUserMedia");2!==arguments.length&&(n=e,e={video:!0,audio:!0}),i.call(navigator,e,r,o)}}},{"react-native-webrtc":11}],74:[function(e,t,n){"use strict";t.exports=function(){return!1}},{}],75:[function(e,t,n){"use strict";t.exports=function(){var t;try{t=e("react-native-webrtc")}catch(n){throw new Error("Missing react-native-webrtc!")}return{RTCPeerConnection:t.RTCPeerConnection,RTCSessionDescription:t.RTCSessionDescription,RTCIceCandidate:t.RTCIceCandidate}}},{"react-native-webrtc":11}],76:[function(e,t,n){arguments[4][64][0].apply(n,arguments)},{"../../lib/copyStyle":2,"../../lib/temasys":8,dup:64}],77:[function(e,t,n){arguments[4][65][0].apply(n,arguments)},{"../../lib/temasys":8,dup:65}],78:[function(e,t,n){"use strict";t.exports=function(){var t=e("detect-browser");return"safari"===t.name&&"undefined"==typeof cordova}},{"detect-browser":14}],79:[function(e,t,n){arguments[4][67][0].apply(n,arguments)},{"../../lib/temasys/MockRTC":4,dup:67}],80:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){throw new Error("No DOM, what are you doing?")}}},{}],81:[function(e,t,n){"use strict";t.exports=function(){return function(e,t){2!==arguments.length&&(t=e);var n=new Error("MediaStreamError");return n.name="NotSupportedError",t(n)}}},{}],82:[function(e,t,n){"use strict";t.exports=function(){return{RTCPeerConnection:null,RTCSessionDescription:null,RTCIceCandidate:null}}},{}]},{},[1])(1)});